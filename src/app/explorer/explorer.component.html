<div class="workspace" #workspace>
  <div class="line">
    <a class="open-work-space" (click)="openWorkSpace()">open work space</a>
    <img title="reload explorer" src="assets/setting.svg" class="icon-sync" (click)="clickSetting();" />
  </div>
  <div *ngIf="isSetting" class="setting">
    <div class="theme">Theme</div>
    <div>Markdown Theme</div>
    <select (change)="changeCodemirrorTheme($event)">
      <option [selected]="theme === selectedCodemirrortheme" *ngFor="let theme of comdemirrorTheme" [value]="theme">{{theme}}</option>
    </select>
    <div>hightlight Theme</div>
    <select (change)="changeHightTheme($event)">
      <option [selected]="theme === selectedHightTheme" *ngFor="let theme of hightlightTheme" [value]="theme">{{theme}}</option>
    </select>
  </div>
  <div>
    <input type="text" placeholder="grep" [(ngModel)]="search" class="search" (keydown.enter)="doSearch()">
  </div>
  <div class="line">
    <img title="reload explorer" src="assets/sync.svg" class="icon-sync" (click)="monitoringExplorer()" />
    <img title="close folder" src="assets/close.svg" class="icon-close" (click)="closeFolder()" />
  </div>

</div>

<ng-template #rowsTemplate let-rows>
  <ng-container *ngFor="let row of rows">
    <ng-container *ngIf="row.isDirectory">
      <div class="line" (click)="folerOnOff(row)" [style.padding-left]="10 * row.depth + 'px'" (contextmenu)="onRightClick(row)">
        <div class="icon-svg-exploler close" *ngIf="!row.opened">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M8 5v14l11-7z" />
            <path d="M0 0h24v24H0z" fill="none" />
          </svg>
        </div>
        <div class="icon-svg-exploler open" *ngIf="row.opened">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M5.875,16h10.5V5.5L5.875,16z" />
            <path d="M0 0h24v24H0z" fill="none" />
          </svg>
        </div>
        <span class="name" [class.right-click]="isRightClick(row)">{{row.name}}</span>
      </div>
      <ng-container *ngIf="row.opened">
        <ng-container *ngTemplateOutlet="rowsTemplate; context: {$implicit: row.childTree}"></ng-container>
      </ng-container>
    </ng-container>
    <ng-container *ngIf="!row.isDirectory">
      <ng-container *ngIf="isImage(row.name)">
        <a class="line" (contextmenu)="onRightClick(row)" [href]="getLocalImageUrl(row)" [attr.data-lightbox]="getBase64LocalImageUrl(row)" [class.active]="isActive(row)" [style.padding-left]="10 * row.depth + 'px'">
          <img class="tree-icon" [src]="getFileIcon(row)" />
          <span class="name" [class.right-click]="isRightClick(row)">{{row.name}}</span>
        </a>
      </ng-container>
      <ng-container *ngIf="!isImage(row.name)">
        <div class="line" (contextmenu)="onRightClick(row)" (click)="openFile(row)" [class.active]="isActive(row)" [style.padding-left]="10 * row.depth + 'px'">
          <img class="tree-icon" [src]="getFileIcon(row)" />
          <span class="name" [class.right-click]="isRightClick(row)">{{row.name}}</span>
        </div>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-template>

<div class="css-treeview" #tree>
  <ng-container *ngIf="treeExplorer">
    <ng-container *ngTemplateOutlet="rowsTemplate; context: {$implicit: treeExplorer.childTree}"></ng-container>
  </ng-container>
</div>
